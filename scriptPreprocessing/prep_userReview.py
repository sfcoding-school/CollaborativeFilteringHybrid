import json

howmuch = {}

i = 0
while True:
    try:
        with open('dataset/userReviewFolder/userReview' + str(i) + '.json') as data_file:
            db = json.load(data_file)
        i += 1
        for ur in db:
            if str(len(db[ur])) in howmuch:
                howmuch[str(len(db[ur]))] += 1
            else:
                howmuch[str(len(db[ur]))] = 1
    except Exception, e:
        break
print "done"
print howmuch

# ########################################################################################################

# listUserId = {}

# i = 0
# while True:
#     try:
#         with open('dataset/userNewFolder/userNew' + str(i) + '.json') as data_file:
#             db = json.load(data_file)
#         i += 1
#         for user in db:
#             for onlyUserId in user:
#                 listUserId[onlyUserId] = {"rev": []}
#     except Exception, e:
#         break
# print "done"

# i = 0
# while True:
#     try:
#         with open('dataset/reviewNewFolder/reviewNew' + str(i) + '.json') as data_file:
#             db = json.load(data_file)
#         i += 1
#         for review in db:
#             for onlyReviewId in review:
#                 listUserId[review[onlyReviewId]["usr_id"]]["rev"].append(review[onlyReviewId]["buss_id"])
#     except Exception, e:
#         break
# print "done"

# listTemp = {}

# i = 0
# j = 0
# for x in listUserId:
#     if i == 10000:
#         text_file = open("dataset/userReviewFolder/userReview" + str(j) + ".json", "w")
#         text_file.write(json.dumps(listTemp))
#         text_file.close()
#         i = 0
#         j += 1
#         print j
#         listTemp = {}
#     # print listTemp[x], listUserId[x]
#     listTemp[x] = listUserId[x]["rev"]
#     i += 1

# text_file = open("dataset/userReviewFolder/userReview" + str(j) + ".json", "w")
# text_file.write(json.dumps(listTemp))
# text_file.close()

# # print "done"

# # text_file = open("userReview.json", "w")
# # text_file.write(json.dumps(listUserId))
# # text_file.close()

# print "terminato"


# {'344': 3, '819': 1, '346': 1, '340': 1, '341': 1, '348': 1, '718': 1, '298': 2, '299': 2, '297': 1, '294': 1, '292': 2, '290': 1, '199': 3, '198': 4, '1080': 1, '195': 3, '194': 2, '197': 4, '196': 5, '191': 7, '190': 2, '193': 7, '192': 5, '270': 4, '272': 2, '274': 1, '275': 1, '277': 2, '278': 1, '279': 3, '523': 1, '441': 1, '440': 1, '108': 23, '109': 22, '102': 21, '103': 16, '100': 18, '101': 14, '106': 16, '107': 18, '104': 23, '105': 13, '39': 164, '38': 167, '33': 249, '32': 237, '31': 255, '30': 286, '37': 188, '36': 168, '35': 209, '34': 223, '647': 1, '646': 1, '436': 2, '432': 1, '335': 2, '336': 1, '333': 1, '332': 2, '6': 9193, '99': 11, '98': 16, '91': 29, '90': 28, '93': 24, '92': 15, '95': 23, '94': 14, '97': 23, '96': 20, '743': 1, '557': 1, '238': 2, '239': 3, '234': 2, '235': 2, '237': 2, '230': 1, '232': 1, '233': 2, '1': 188260, '146': 12, '147': 7, '144': 10, '145': 9, '142': 12, '143': 5, '140': 8, '141': 11, '613': 1, '148': 7, '149': 9, '941': 1, '680': 1, '133': 15, '132': 12, '131': 14, '130': 11, '137': 12, '136': 8, '135': 13, '134': 14, '495': 1, '139': 8, '138': 10, '24': 504, '25': 426, '26': 393, '27': 386, '20': 725, '21': 647, '22': 572, '23': 509, '28': 356, '29': 337, '407': 1, '402': 1, '378': 2, '371': 1, '374': 1, '376': 2, '391': 2, '89': 27, '397': 1, '395': 1, '82': 33, '83': 22, '80': 29, '81': 27, '86': 30, '87': 21, '84': 19, '85': 25, '796': 1, '7': 6837, '582': 1, '245': 2, '244': 1, '247': 1, '246': 8, '241': 3, '240': 1, '243': 1, '242': 1, '249': 1, '248': 2, '519': 2, '518': 1, '511': 1, '459': 1, '1225': 1, '626': 1, '454': 1, '456': 1, '179': 4, '178': 3, '177': 4, '176': 5, '175': 5, '174': 4, '173': 3, '172': 7, '171': 8, '170': 9, '253': 1, '182': 5, '183': 10, '180': 4, '181': 3, '186': 3, '187': 3, '184': 4, '185': 6, '188': 8, '189': 2, '11': 2655, '10': 3305, '13': 1853, '12': 2112, '15': 1410, '14': 1579, '17': 1095, '16': 1258, '19': 812, '18': 881, '62': 51, '320': 1, '321': 1, '326': 1, '327': 1, '324': 1, '325': 1, '329': 2, '201': 1, '200': 1, '203': 7, '202': 2, '205': 5, '204': 7, '207': 1, '206': 4, '209': 3, '208': 4, '77': 43, '76': 44, '75': 28, '74': 37, '73': 35, '72': 38, '71': 44, '70': 48, '79': 26, '78': 28, '2': 61354, '695': 1, '542': 1, '544': 1, '8': 5234, '548': 1, '549': 1, '68': 40, '120': 11, '121': 10, '122': 8, '123': 17, '124': 8, '125': 4, '126': 7, '127': 7, '128': 8, '129': 17, '415': 1, '417': 1, '922': 1, '499': 1, '318': 3, '313': 3, '312': 2, '310': 1, '316': 1, '315': 2, '3': 31355, '368': 3, '369': 1, '362': 1, '363': 1, '360': 2, '381': 2, '386': 1, '573': 1, '572': 1, '571': 1, '60': 49, '61': 51, '258': 2, '259': 2, '64': 45, '65': 50, '66': 46, '67': 39, '252': 1, '69': 43, '250': 1, '256': 4, '257': 1, '1427': 1, '504': 2, '633': 1, '466': 1, '461': 2, '460': 1, '462': 1, '168': 1, '169': 9, '164': 4, '165': 2, '166': 13, '167': 5, '160': 8, '161': 4, '162': 11, '163': 7, '908': 1, '877': 1, '874': 1, '9': 4070, '439': 1, '356': 2, '354': 3, '353': 1, '352': 1, '350': 1, '359': 1, '358': 1, '216': 2, '217': 1, '214': 5, '215': 5, '212': 3, '213': 2, '210': 5, '211': 4, '763': 1, '218': 1, '219': 3, '289': 1, '288': 1, '4': 19019, '281': 1, '280': 1, '283': 1, '282': 1, '285': 3, '284': 1, '287': 4, '286': 1, '674': 1, '263': 1, '262': 2, '260': 3, '267': 1, '266': 1, '269': 4, '268': 1, '59': 47, '58': 56, '55': 71, '54': 68, '57': 55, '56': 72, '51': 89, '50': 101, '53': 81, '52': 81, '63': 28, '531': 1, '538': 1, '115': 18, '114': 15, '117': 17, '116': 14, '111': 18, '110': 19, '113': 16, '112': 12, '119': 12, '118': 18, '429': 1, '422': 3, '308': 1, '309': 3, '300': 1, '301': 1, '302': 1, '303': 1, '305': 1, '307': 4, '753': 1, '750': 1, '562': 1, '566': 2, '229': 4, '228': 2, '227': 2, '226': 2, '225': 2, '224': 1, '223': 2, '222': 4, '221': 2, '220': 1, '1186': 1, '88': 21, '151': 7, '150': 7, '153': 3, '152': 6, '155': 13, '154': 8, '157': 5, '156': 5, '159': 6, '158': 6, '399': 1, '48': 90, '49': 99, '46': 115, '47': 93, '44': 123, '45': 113, '42': 149, '43': 120, '40': 158, '41': 153, '5': 12972, '475': 2, '478': 1}
